/*! =========================================================        
          .o88
          "888
 .oooo.    888  .oo.    ..o88.     ooo. .oo.    .oooo`88
d88' `8b   88bP"Y88b   888P"Y88b  "888P"Y88b   888' `88b 
888        88b   888   888   888   888   888   888   888
888. .88   888   888   888   888   888   888   888. .880
 8`bo8P'  o888o o888o   8`bod8P'  o888o o888o   .oooo88o
                                                     088`
                                                    .o88
============================================================ */window.onbeforeunload=function(e){};var Dialog={load:function(e,t,o,n){Event.showMsg({load:!0}),this.fetch(e,t).done(function(e){return e.error?(e.message&&""!=e.message||(e.message="Error!"),Event.showMsg({text:e.message,load:1,auto:1}),!1):void Dialog.open($.extend({},o,e,n))})},fetch:function(e,t){return $.ajax({url:e,data:t,dataType:"json"}).always(function(){Event.hideMsg()}).fail(function(){Event.showMsg({text:"เกิดข้อผิดพลาด...",load:!0,auto:!0})})},open:function(e,t){var o=this;o.settings=$.extend({},$.fn.dialog.options,e),"function"!=typeof e.onClose?o.close(1):(o.$old=$("body").find(".model.active.model-dialog"),o.$old.removeClass("active")),"function"==typeof t&&(o.settings.onOpen=t),o.createDialog(),o.buildFrag(),o.resize(),$(window).resize(function(){o.resize()}),o.settings.effect?setTimeout(function(){o.display()},150):o.display()},buildFrag:function(){var e=this;e.$pop.html(e.setContent(e.settings)),e.settings.effect&&e.$dialog.addClass("effect-"+e.settings.effect),e.settings.width&&("full"==e.settings.width&&(e.settings.width=$(window).width()-80),e.$pop.css("width",e.settings.width)),0==e.$pop.find("[role=dialog-close]").length?(e.$close=$("<a/>",{href:"#"}).addClass("model-close").html($("<i/>",{"class":"icon-remove"})),e.$pop.append(e.$close)):(e.$close=e.$pop.find("[role=dialog-close]"),e.$close.removeAttr("role")),e.$dialog.addClass(e.settings.bg||"black")},resize:function(){var e=this,t=$(window).height(),o=80;if(e.settings.height){var n=e.settings.height,s=e.settings.overflowY||"scroll",i=e.$pop.find(e.settings.$height||".model-body"),l=0;inner=i.outerHeight(),t-=o,l+=e.$pop.find(".model-title").outerHeight(),l+=e.$pop.find(".model-summary").outerHeight(),l+=e.$pop.find(".model-buttons").outerHeight(),"auto"==n&&inner+l>t?n=parseInt(t-l):"full"==n&&(e.$pop.find(".model-body").css("padding",0),n=parseInt(t-l)),i.css({height:n,overflowY:s})}e.$pop.height()>t-o?$("body").addClass("overflow-page"):$("body").hasClass("overflow-page")&&$("body").removeClass("overflow-page");var d=$(window).height()/2-e.$pop.height()/2;d=25>d?25:d,e.$pop.css("margin-top",d)},display:function(){var e=this;Event.plugins(e.$dialog),$("html").hasClass("hasModel")||(setTimeout(function(){$("html").addClass("hasModel")},200),e.$doc.addClass("fixed_elem").css("top",-1*$(window).scrollTop())),$(window).scrollTop(0),e.$dialog.addClass("show").addClass("active"),"function"==typeof e.settings.onOpen&&e.settings.onOpen(e),"function"==typeof e.settings.onForm&&e.settings.onForm(e.$pop.find(".model-content")[0]);var t=!1;e.$dialog.find(".model-content").mouseover(function(){t=!0}).mouseenter(function(){t=!0}).mouseleave(function(){t=!1}),e.settings.is_close_bg&&e.$dialog.click(function(){t||e.close()}),$.data(e.$dialog[0],e),e.resize(),e.Event()},Event:function(){var e=this;e.$close.click(function(t){t.preventDefault(),e.close()}),$("[role=submit]",e.$model).click(function(t){t.preventDefault(),"function"==typeof e.settings.onSubmit&&e.settings.onSubmit(e,$.data(e.$pop.find(".model-content")[0]))}),$("[role=cancel]",e.$model).click(function(t){t.preventDefault(),"function"==typeof e.settings.onCancel&&e.settings.onCancel(e,$.data(e.$pop.find(".model-content")[0]))}),1==e.$pop.find(":input[autofocus]").first().length&&e.$pop.find(":input[autofocus]").first().focus(),1==e.$pop.find(":input[autoselect]").first().length&&e.$pop.find(":input[autoselect]").first().select()},close:function(e){var t=this,o=$("body").find(".model.active.model-dialog"),n=parseInt($("#doc").css("top"));if(n=0>n?-1*n:n,o.removeClass("show"),setTimeout(function(){o.remove(),0==$("body").find(".model").not(".hidden_elem").length&&($("html").removeClass("hasModel"),$("#doc").removeClass("fixed_elem").css("top",""),$(window).scrollTop(n),$("body").hasClass("overflow-page")&&$("body").removeClass("overflow-page"))},e||300),!t.settings)return!1;if(t.$old){var s=t.$old.data();s&&"function"==typeof s.resize&&s.resize()}"function"==typeof t.settings.onClose&&(t.settings.onClose(),t.$old&&t.$old.addClass("active"))},setHiddenInput:function(e){return $.map(e,function(e,t){return $("<input/>",{"class":"hiddenInput",type:"hidden",autocomplete:"off"}).attr(e)[0]})},setContent:function(e){var t=$(e.form||"<div/>").addClass("model-content").addClass(e.addClass).addClass(e.style?"style-"+e.style:"");if(e.hiddenInput&&t.append(this.setHiddenInput(e.hiddenInput)),e.title&&t.append($("<div/>",{"class":"model-title"}).html(e.title)),e.summary&&t.append($("<div/>",{"class":"model-summary"}).html(e.summary)),e.body&&t.append($("<div/>",{"class":"model-body"}).html(e.body)),e.button||e.bottom_msg){var o=$("<div/>",{"class":"model-buttons clearfix"});e.button&&o.append($("<div/>",{"class":"rfloat mlm"}).html(e.button)),e.bottom_msg&&o.append($("<div/>",{"class":"model-buttons-msg"}).html(e.bottom_msg)),t.append(o)}return e.footer&&t.append($("<div/>",{"class":"model-footer"}).html(e.footer)),t},createDialog:function(){var e=this;e.classDefault="model model-dialog",e.$pop=$("<div/>",{"class":"model-container"}),e.$dialog=$("<div/>").addClass(e.classDefault).html(e.$pop),e.$doc=$("#doc"),$("body").append(e.$dialog)}};"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),function(e,t,o,n){e.fn.dialog=function(t){return this.each(function(){var o=e(this),n=o.attr("href");return n?void o.removeAttr("href").click(function(e){e.preventDefault(),Dialog.load(n,{},t)}):!1})},e.fn.dialog.options={effect:5,onOpen:function(){},onClose:function(){}}}(jQuery,window,document);